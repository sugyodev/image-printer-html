<!DOCTYPE html>
<html>

<head>
    <title>Alrajhi-capital</title>
    <link rel="stylesheet" href="./css/index.css" />
    <script src="./js/dom-to-image.min.js"></script>

    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html" charset="utf-8">
    </head>
</head>

</style>

<body>
    <div class="header"></div>
    <div style="height: 100vh;">
        <div id="content">
            <img src="./imgs/logo-horizon.png" id="logo1">
            <img src="./imgs/logo-vertical.png" id="logo2">
            <p class="upload-text">Please upload an image</p>
            <input type="file" name="file" id="file">
            <div id="upload-status"><span id="generated-link"></span><img src="./imgs/copy-icon.png" width="20"
                    onclick="copyClipboard()" /></div>
            <button onclick="generate()" class="create-btn">
                <p>Create a link</p><span class="loader"></span>
            </button>
        </div>
    </div>
    <script>
        const input = document.getElementById('file');
        input.onchange = function (e) {
            document.getElementById('upload-status').style.display = "none"
        }
        function generate() {
            const input = document.getElementById('file');
            var loader = document.getElementsByClassName('loader')[0];
            const file = input.files[0];
            if (!file) {
                alert('Please choose a file.');
                return;
            }
            const apiKey = '94db8bb599d6e0580b8f1eff0969c632'; // Replace with your ImgBB API key

            const formData = new FormData();
            formData.append('image', file);
            formData.append('key', apiKey);

            const xhr = new XMLHttpRequest();
            loader.style.display = 'inline-block';
            xhr.open('POST', 'https://api.imgbb.com/1/upload');
            xhr.onload = function () {
                if (xhr.status === 200) {
                    loader.style.display = 'none';
                    const url = JSON.parse(xhr.responseText).data.url;
                    document.getElementById('generated-link').textContent = `${window.location.host}/employee.html?url=${btoa(url)}`;
                    document.getElementById('upload-status').style.display = "block"
                } else {
                    loader.style.display = 'none';
                    alert('Error uploading image. Please try again later.');
                }
            };
            xhr.send(formData);
        }

        function copyClipboard() {
            const text = document.getElementById('generated-link');
            if (!navigator.clipboard) {
                alert('error');
            } else {
                navigator.clipboard.writeText(text.textContent);
            }
        }

    </script>
</body>

</html>